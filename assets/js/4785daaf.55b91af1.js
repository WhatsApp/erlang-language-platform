"use strict";(self.webpackChunkstaticdocs_starter=self.webpackChunkstaticdocs_starter||[]).push([[3553],{95396:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"get-started/editors/emacs","title":"Emacs","description":"The ELP project can be used as a","source":"@site/docs/get-started/editors/emacs.md","sourceDirName":"get-started/editors","slug":"/get-started/editors/emacs","permalink":"/erlang-language-platform/docs/get-started/editors/emacs","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Configure Your Editor","permalink":"/erlang-language-platform/docs/get-started/editors/"},"next":{"title":"VS Code","permalink":"/erlang-language-platform/docs/get-started/editors/vscode"}}');var s=t(74848),a=t(28453);const r={sidebar_position:2},i="Emacs",l={},c=[{value:"Eglot",id:"eglot",level:2},{value:"Configuration",id:"configuration",level:3},{value:"Semantic tokens",id:"semantic-tokens",level:3},{value:"lsp-mode",id:"lsp-mode",level:2},{value:"Configuration",id:"configuration-1",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"The following servers support current file but do not have automatic installation",id:"the-following-servers-support-current-file-but-do-not-have-automatic-installation",level:4}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"emacs",children:"Emacs"})}),"\n",(0,s.jsxs)(n.p,{children:["The ELP project can be used as a\n",(0,s.jsx)(n.a,{href:"https://microsoft.github.io/language-server-protocol/overviews/lsp/overview/",children:"language server"}),"\nin the Emacs text editor via the ",(0,s.jsx)(n.a,{href:"https://github.com/joaotavora/eglot",children:"eglot"})," or\n",(0,s.jsx)(n.a,{href:"https://emacs-lsp.github.io/lsp-mode/",children:"lsp-mode"})," LSP clients."]}),"\n",(0,s.jsx)(n.h2,{id:"eglot",children:"Eglot"}),"\n",(0,s.jsxs)(n.p,{children:["Eglot is part of Emacs core since Emacs 29. For earlier versions it can be\ninstalled with the ",(0,s.jsx)(n.code,{children:"eglot"})," package."]}),"\n",(0,s.jsx)(n.h3,{id:"configuration",children:"Configuration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-elisp",children:'(use-package eglot\n  :ensure t\n  :hook ((erlang-mode . eglot-ensure))\n\n  :config\n  ;; Remove default LSP server\n  (setopt eglot-server-programs\n          (assq-delete-all \'erlang-mode eglot-server-programs))\n\n  ;; Enable ELP\n  (add-to-list \'eglot-server-programs\n               \'(erlang-mode . ("elp" "server"))))\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Refer to the\n",(0,s.jsx)(n.a,{href:"https://elpa.gnu.org/devel/doc/eglot.html#Customization-Variables",children:"manual"})," for\nadditional configuration options."]}),"\n",(0,s.jsx)(n.h3,{id:"semantic-tokens",children:"Semantic tokens"}),"\n",(0,s.jsx)(n.p,{children:"Semantic token support has been added to eglot, but is not yet in the\nreleased version. But it is possible to install the updated version\nof eglot."}),"\n",(0,s.jsx)(n.p,{children:"To do so, add"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-elisp",children:'(add-to-list \'package-archives \'("gnu-devel" . "https://elpa.gnu.org/devel/"))\n'})}),"\n",(0,s.jsxs)(n.p,{children:["to your ",(0,s.jsx)(n.code,{children:"init.el"}),", then run ",(0,s.jsx)(n.code,{children:"M-x eglot-upgrade-eglot"})]}),"\n",(0,s.jsxs)(n.p,{children:["Once upgraded, add the following to the ",(0,s.jsx)(n.code,{children:"(use-package"})," entry for ",(0,s.jsx)(n.code,{children:"eglot"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-elisp",children:'  (setq eglot-semantic-token-modifiers \'\n    ("bound" "exported_function" "exported_type" "deprecated_function" "type_dynamic"))\n\n  ;; Each face name arises as a template from the modifiers as\n  ;; "eglot-semantic-%s-face"\n  (defface eglot-semantic-bound-face\n    \'((t :underline t))\n    "The face modification to use for bound variables in patterns."\n    :group \'eglot-semantic-semantic-tokens)\n\n  (defface eglot-semantic-exported_function-face\n    \'((t :underline t))\n    "The face modification to use for exported functions."\n    :group \'eglot-semantic-semantic-tokens)\n\n  (defface eglot-semantic-exported_type-face\n    \'((t :underline t))\n    "The face modification to use for exported types."\n    :group \'eglot-semantic-semantic-tokens)\n\n  (defface eglot-semantic-deprecated_function-face\n    \'((t :strike-through t))\n    "The face modification to use for deprecated functions."\n    :group \'eglot-semantic-semantic-tokens)\n\n  (defface eglot-semantic-type_dynamic-face\n    \'((t (:weight bold)))\n    "The face modification to use for dynamic types."\n    :group \'eglot-semantic-semantic-tokens)\n\n  ;; Bare eglot makes the refresh a no-op. Provide our own version for\n  ;; when Eqwalizer gets its results.\n  (cl-defmethod eglot-handle-request\n    (server (_method (eql workspace/semanticTokens/refresh)) &rest args)\n    "Handle workspace/semanticTokens/refresh by refreshing font-lock."\n    (dolist (buffer (eglot--managed-buffers server))\n      (eglot--when-live-buffer buffer\n        (eglot--widening (font-lock-flush)))))\n'})}),"\n",(0,s.jsx)(n.h2,{id:"lsp-mode",children:"lsp-mode"}),"\n",(0,s.jsxs)(n.p,{children:["Install the ",(0,s.jsx)(n.code,{children:"lsp-mode"})," package, which is a generic Emacs client for LSP servers.\nYou can follow\n",(0,s.jsx)(n.a,{href:"https://emacs-lsp.github.io/lsp-mode/page/installation/",children:"these instructions"})," to\ninstall it."]}),"\n",(0,s.jsx)(n.h3,{id:"configuration-1",children:"Configuration"}),"\n",(0,s.jsxs)(n.p,{children:["Add the following to your emacs ",(0,s.jsx)(n.code,{children:".emacs"})," file or equivalent."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-elisp",children:"(use-package lsp-mode\n\n  :config\n  ;; Enable LSP automatically for Erlang files\n  (add-hook 'erlang-mode-hook #'lsp)\n\n  ;; ELP, added as priority 0 (> -1) so takes priority over the built-in one\n  (lsp-register-client\n   (make-lsp-client :new-connection (lsp-stdio-connection '(\"elp\" \"server\"))\n                    :major-modes '(erlang-mode)\n                    :priority 0\n                    :server-id 'erlang-language-platform))\n  )\n"})}),"\n",(0,s.jsxs)(n.p,{children:["For a list of available configuration option, please refer to\n",(0,s.jsx)(n.a,{href:"https://emacs-lsp.github.io/lsp-mode/page/lsp-erlang-elp/",children:"this page"})," and to\nthe\n",(0,s.jsxs)(n.a,{href:"https://emacs-lsp.github.io/lsp-mode/page/settings/mode/",children:[(0,s.jsx)(n.code,{children:"lsp-mode"})," settings documentation"]}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["There is also a\n",(0,s.jsx)(n.a,{href:"https://github.com/WhatsApp/erlang-language-platform/blob/main/editors/emacs/dotemacs.el",children:(0,s.jsx)(n.code,{children:".dotemacs"})}),"\nfile in the ELP repository that you can use as a reference."]}),"\n",(0,s.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,s.jsx)(n.h4,{id:"the-following-servers-support-current-file-but-do-not-have-automatic-installation",children:"The following servers support current file but do not have automatic installation"}),"\n",(0,s.jsxs)(n.p,{children:["Ensure that the ",(0,s.jsx)(n.code,{children:"elp"})," executable is available in your ",(0,s.jsx)(n.code,{children:"PATH"})," via Emacs. A\nworkaround is:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-elisp",children:";; Ensure your Emacs environment looks like your user's shell one\n(package-require 'exec-path-from-shell)\n(exec-path-from-shell-initialize)\n"})})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>i});var o=t(96540);const s={},a=o.createContext(s);function r(e){const n=o.useContext(a);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),o.createElement(a.Provider,{value:n},e.children)}}}]);